var primitives = require("lib/util/primitives");
var check = require('check-types');
var type_of = require('lib/util/type_of');

//used to add functionality to createjs objects, such that they can add themselves to the stage
//	if an object is already on the stage, then the function does nothing
function add_to_stage(obj) {
	//is argument a createjs object?
	if(!(check.instanceStrict(obj, createjs.DisplayObject))) {
		throw new TypeError('Cannot add object of type: ' + type_of(obj) + " to stage, requires createjs DisplayObject");
	}
	
	//is the stage already registered?
	var stage = primitives.get('stage');
	if (check.undefined(stage) || check.not.object(stage)) {
		throw new ReferenceError("'stage' undefined or not object in primitives object.");
	}
	
	var ret;
	
	//create a function used to decorate the createjs object, so it can be called to have the object add itself to the stage
	ret = function() {
		//is the object already on the stage?
		if(!(stage.contains(obj))) {
			//if not then add it
			stage.addChild(obj);
			stage.update();
		}
		//if it's already on the stage, do nothing
	};
	
	return ret;
};

module.exports = add_to_stage;